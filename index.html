<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Zillow Rental Manager</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <!-- Splash Screen -->
    <div id="splash-screen">
        <div class="logo-container">
            <img src="zillow_logo_new.png" alt="Zillow Logo" class="splash-logo">
        </div>
    </div>

    <!-- Main App -->
    <div id="app" class="hidden">

        <!-- Top App Bar -->
        <header class="app-bar">
            <button id="settings-btn" class="icon-btn" aria-label="Settings">
                <span class="mode-icon">‚öôÔ∏è</span>
            </button>
            <div class="brand">
                <img src="zillow_logo_new.png" alt="Logo" class="app-logo">
                <h1>Zillow</h1>
            </div>
            <div class="header-actions">
                <button id="theme-toggle" class="icon-btn" aria-label="Toggle Dark Mode">
                    <!-- Moon Icon (for Light Mode) -->
                    <span class="moon-icon mode-icon">üåô</span>
                    <!-- Sun Icon (for Dark Mode) -->
                    <span class="sun-icon mode-icon hidden">üîÜ</span>
                </button>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="bottom-nav">
            <button class="nav-item active" data-target="dashboard">
                <span class="icon">üõí</span>
                <span class="label">Orders</span>
            </button>
            <button class="nav-item" data-target="add-order">
                <span class="icon">‚ûï</span>
                <span class="label">New</span>
            </button>
            <button class="nav-item" data-target="calendar">
                <span class="icon">üìÖ</span>
                <span class="label">Calendar</span>
            </button>
            <button class="nav-item" data-target="settings">
                <span class="icon">‚ò∞</span>
                <span class="label">Options</span>
            </button>
        </nav>

        <!-- Views -->
        <main class="content-area">

            <!-- Dashboard View -->
            <section id="dashboard" class="view active">
                <div class="view-header">
                    <h2>My Orders</h2>
                    <div class="filter-badge"></div>
                </div>

                <div id="orders-list" class="orders-list">
                    <!-- Orders will be injected here -->
                    <div class="empty-state">
                        <p>No active rentals.</p>
                        <button class="btn-primary" onclick="navTo('add-order')">Add First Order</button>
                    </div>
                </div>
            </section>

            <!-- Add Order View -->
            <section id="add-order" class="view">
                <div class="view-header">
                    <h2 id="form-title">New Rental</h2>
                </div>
                <form id="order-form">
                    <input type="hidden" id="edit-order-id"> <!-- Hidden field to store ID being edited -->
                    <div class="form-group">
                        <label>Product Name</label>
                        <select id="product-select" required>
                            <option value="" disabled selected>Select Product</option>
                            <!-- Populated from settings -->
                        </select>
                    </div>

                    <div class="form-group">
                        <label>User Name</label>
                        <input type="text" id="user-name" placeholder="Your Name" required>
                    </div>

                    <div class="form-group">
                        <label>Location</label>
                        <input type="text" id="location" placeholder="City, Area" required>
                    </div>

                    <div class="form-group">
                        <label>Proof 1</label>
                        <div class="file-upload-wrapper">
                            <input type="text" id="proof-name" placeholder="Doc Name (e.g. Aadhaar)" required>
                            <label for="proof-file" class="file-btn">File</label>
                            <input type="file" id="proof-file" accept="image/*" class="hidden">
                            <span id="file-name-display"></span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Proof 2</label>
                        <div class="file-upload-wrapper">
                            <input type="text" id="alt-proof-name" placeholder="Doc Name (e.g. DL, SSLC)">
                            <label for="alt-proof-file" class="file-btn">File</label>
                            <input type="file" id="alt-proof-file" accept="image/*" class="hidden">
                            <span id="alt-file-name-display"></span>
                        </div>
                    </div>

                    <div class="row">
                        <div class="form-group">
                            <label>Phone 1</label>
                            <input type="tel" id="phone-1" placeholder="Phone Number" required>
                        </div>
                        <div class="form-group">
                            <label>Phone 2</label>
                            <input type="tel" id="phone-2" placeholder="Alternate Number">
                        </div>
                        <div class="form-group">
                            <label>Phone 3</label>
                            <input type="tel" id="phone-3" placeholder="Optional Number">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Start Date & Time</label>
                        <input type="datetime-local" id="start-date" required>
                    </div>

                    <div class="form-group">
                        <label>End Date & Time</label>
                        <input type="datetime-local" id="end-date" required>
                    </div>

                    <div class="form-group">
                        <label>Extra Details</label>
                        <input type="text" id="extra-details" placeholder="Vehicle Number, Notes...">
                    </div>

                    <div class="form-group">
                        <label for="manual-amount">Total Amount (Optional Override) ‚Çπ</label>
                        <input type="number" id="manual-amount" placeholder="Leave empty for auto-calculation">
                    </div>

                    <div class="form-actions">
                        <button type="submit" id="submit-btn" class="btn-primary full-width">Create Order</button>
                    </div>
                </form>
            </section>

            <!-- Calendar View -->
            <section id="calendar" class="view">
                <div class="view-header">
                    <h2>Schedule</h2>
                </div>
                <!-- Enhanced Calendar -->
                <div class="calendar-container">
                    <div class="calendar-header-controls">
                        <button id="cal-prev" class="icon-btn">&lt;</button>
                        <h3 id="cal-month-year">Month Year</h3>
                        <button id="cal-next" class="icon-btn">&gt;</button>
                    </div>

                    <div class="calendar-wrapper">
                        <div id="calendar-grid" class="calendar-grid"></div>
                    </div>

                    <div id="calendar-details" class="calendar-details">
                        <h4>Select a date to view rentals</h4>
                        <div id="cal-selected-orders" class="cal-orders-list"></div>
                    </div>
                </div>
            </section>

            <!-- Options View -->
            <section id="settings" class="view">
                <div class="view-header">
                    <h2>Options</h2>
                </div>
                <div class="settings-card">
                    <div style="margin-bottom:10px;">
                        <h3>Product Rates (‚Çπ)</h3>
                    </div>
                    <div id="rates-list" style="margin-bottom: 20px;">
                        <!-- Rates injected here -->
                    </div>

                    <h4 style="margin-bottom:10px; color:var(--text-secondary); font-weight:500;">Add New Product</h4>
                    <form id="add-rate-form" style="margin-bottom: 30px;">
                        <div class="form-group" style="margin-bottom: 20px;">
                            <input type="text" id="new-product-name" placeholder="Product Name" required
                                style="margin-bottom: 10px;">
                            <input type="number" id="new-product-rate" placeholder="Rate/12hr ‚Çπ" required>
                        </div>
                        <div style="display:flex; justify-content:center;">
                            <button type="submit" class="btn-primary"
                                style="padding: 12px 40px; background:var(--success);">Add Product</button>
                        </div>
                    </form>

                    <!-- Sub-Page Navigation Tabs -->
                    <div class="options-tabs"
                        style="display: flex; gap: 10px; margin-top: 20px; border-top: 1px solid var(--border); padding-top: 20px; margin-bottom: 20px;">
                        <button class="btn-secondary full-width" onclick="toggleSubView('embedded-completed')"
                            style="display:flex; align-items:center; justify-content:center; gap:8px; padding:12px; font-weight:600;">
                            <span>üìú</span> History
                        </button>
                        <button class="btn-secondary full-width" onclick="toggleSubView('embedded-earnings')"
                            style="display:flex; align-items:center; justify-content:center; gap:8px; padding:12px; font-weight:600;">
                            <span>üìà</span> Earnings
                        </button>
                    </div>

                    <!-- Embedded Completed View -->
                    <div id="embedded-completed" class="embedded-section hidden">
                        <div class="view-header"
                            style="margin-bottom: 10px; display:flex; justify-content:space-between; align-items:center;">
                            <div style="display:flex; align-items:center; gap:10px;">
                                <h3 style="font-size: 1.2rem; margin:0;">History</h3>
                                <div class="filter-badge"></div>
                            </div>
                            <div class="month-filter-group" style="display:flex; align-items:center; gap:5px;">
                                <span id="history-count-display"
                                    style="font-size: 0.9rem; margin-right: 5px; color: var(--text-secondary); font-weight: 500;">(0)</span>
                                <input type="month" id="history-month-picker" onchange="renderCompletedOrders()"
                                    style="padding: 4px; border: 1px solid var(--border); border-radius: 6px; font-family: inherit;">
                                <button id="history-clear-filter" onclick="resetHistoryFilter()" class="btn-sm"
                                    style="display:none; padding: 2px 8px; font-size: 1.2rem; line-height: 1;">‚Ü∫</button>
                            </div>
                        </div>
                        <div id="completed-list" class="orders-list">
                            <!-- Completed Orders will be injected here -->
                            <div class="empty-state">
                                <p>No completed rentals yet.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Embedded Earnings View -->
                    <div id="embedded-earnings" class="embedded-section hidden">
                        <div class="view-header" style="margin-bottom: 10px;">
                            <h3 style="font-size: 1.2rem;">Cash Earnings</h3>
                        </div>
                        <div class="earnings-display">
                            <div class="earnings-card">
                                <div class="earnings-card-header"
                                    style="display:flex; justify-content:space-between; align-items:center;">
                                    <h3>Total value of completed orders</h3>
                                    <div style="display:flex; align-items:center; gap:10px;">
                                        <div class="month-filter-group"
                                            style="display:flex; align-items:center; gap:5px;">
                                            <input type="month" id="report-month-picker" onchange="renderEarnings()"
                                                style="padding: 4px; border: 1px solid var(--border); border-radius: 6px; font-family: inherit;">
                                            <button id="report-clear-filter" onclick="resetReportFilter()"
                                                class="btn-sm"
                                                style="display:none; padding: 2px 8px; font-size: 1.2rem; line-height: 1;">‚Ü∫</button>
                                        </div>
                                        <button class="btn-sm btn-report" onclick="generatePDFReport()"
                                            style="display:flex; align-items:center; gap:5px;">
                                            <span>üìÑ</span> Report
                                        </button>
                                    </div>
                                </div>
                                <div id="cash-total-amount" class="big-amount">‚Çπ0</div>
                                <p></p>
                            </div>

                            <div class="stats-container">
                                <div class="stats-group">
                                    <div class="stats-header"
                                        style="display:flex; justify-content:space-between; align-items:center; border-bottom: 1px solid var(--border); padding-bottom: 8px; margin-bottom: 12px;">
                                        <h4 class="stats-header" style="margin:0; border:none; padding:0;">Monthly
                                            Breakdown</h4>
                                        <div class="month-filter-group"
                                            style="display:flex; align-items:center; gap:5px;">
                                            <input type="month" id="monthly-month-picker" onchange="renderEarnings()"
                                                style="padding: 4px; border: 1px solid var(--border); border-radius: 6px; font-family: inherit;">
                                            <button id="monthly-clear-filter" onclick="resetMonthlyFilter()"
                                                class="btn-sm"
                                                style="display:none; padding: 2px 8px; font-size: 1.2rem; line-height: 1;">‚Ü∫</button>
                                        </div>
                                    </div>
                                    <div id="monthly-stats" class="stats-list">
                                        <!-- Monthly stats injected here -->
                                    </div>
                                </div>

                                <div class="stats-group">
                                    <div class="stats-header"
                                        style="display:flex; justify-content:space-between; align-items:center; border-bottom: 1px solid var(--border); padding-bottom: 8px; margin-bottom: 12px;">
                                        <h4 style="margin:0; border:none; padding:0;">Product Breakdown</h4>
                                        <div class="month-filter-group"
                                            style="display:flex; align-items:center; gap:5px;">
                                            <input type="month" id="product-month-picker" onchange="renderEarnings()"
                                                style="padding: 4px; border: 1px solid var(--border); border-radius: 6px; font-family: inherit;">
                                            <button id="product-clear-filter" onclick="resetProductFilter()"
                                                class="btn-sm"
                                                style="display:none; padding: 2px 8px; font-size: 1.2rem; line-height: 1;">‚Ü∫</button>
                                        </div>
                                    </div>
                                    <div id="product-stats" class="stats-list">
                                        <!-- Product stats injected here -->
                                    </div>
                                </div>

                                <div class="stats-group">
                                    <div class="stats-header"
                                        style="display:flex; justify-content:space-between; align-items:center; border-bottom: 1px solid var(--border); padding-bottom: 8px; margin-bottom: 12px;">
                                        <h4 style="margin:0; border:none; padding:0;">Product Days Breakdown</h4>
                                        <div class="month-filter-group"
                                            style="display:flex; align-items:center; gap:5px;">
                                            <input type="month" id="product-days-month-picker"
                                                onchange="renderEarnings()"
                                                style="padding: 4px; border: 1px solid var(--border); border-radius: 6px; font-family: inherit;">
                                            <button id="product-days-clear-filter" onclick="resetProductDaysFilter()"
                                                class="btn-sm"
                                                style="display:none; padding: 2px 8px; font-size: 1.2rem; line-height: 1;">‚Ü∫</button>
                                        </div>
                                    </div>
                                    <div id="product-days-stats" class="stats-list">
                                        <!-- Product days stats injected here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            </section>

            <!-- Top Level Settings View -->
            <section id="app-settings" class="view">
                <div class="view-header">
                    <h2>Settings</h2>
                </div>
                <div class="orders-list">
                    <!-- Cloned UI Style -->
                    <div class="order-card">
                        <h3>Application Info</h3>
                        <div class="order-detail">Version: 1.0.0</div>
                        <div class="order-detail">Status: Active</div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Image Modal -->
    <div id="image-modal" class="modal hidden">
        <span class="close-modal">&times;</span>
        <img class="modal-content" id="modal-img">
        <div id="modal-caption"></div>
    </div>

    <!-- PDF Generation Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>

    <script src="script.js"></script>
</body>

</html>